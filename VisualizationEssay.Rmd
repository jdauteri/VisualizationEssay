---
title: "Visualization Essay"
author: "Jessica Dauterive"
date: "3/21/2017"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggraph)
library(dplyr)
library(stringr)

library(readr)
url <- "http://dl.tufts.edu/file_assets/generic/tufts:MS115.003.001.00001/0"
if (!file.exists("all-votes.tsv")) {
  download.file(url, "nnv-all-votes.zip")
  unzip("nnv-all-votes.zip", files = "all-votes.tsv")
}
nnv <- read_tsv("all-votes.tsv")
```

```{r, echo=FALSE}
nnv %>%
  filter(State == "New Jersey",
         Office == "Governor") %>% 
  mutate(year = as.integer(str_extract(id, "\\d{4}"))) %>%
  group_by(year, Name, Affiliation, County) %>%
  summarize(Vote = sum(Vote)) %>%
  group_by(year) %>%
  mutate(total_vote = sum(Vote)) %>% 
  ggplot(aes(x = year, y = Vote, color = Name)) +
  geom_line() +
  geom_point()
```

```{r, echo=FALSE}
nnv %>%
  filter(State == "New Jersey",
         Office == "Governor") %>% 
  mutate(year = as.integer(str_extract(id, "\\d{4}"))) %>%
  group_by(year, Name, Affiliation, County) %>%
  summarize(Vote = sum(Vote)) %>%
  group_by(year) %>%
  mutate(total_vote = sum(Vote)) %>% 
  filter(year >= "1800", year <= "1805") %>% 
  ggplot(aes(x = year, y = Vote, color = Name)) +
  geom_line() +
  geom_point()
```

```{r, echo=FALSE}
nnv %>%
  filter(State == "New Jersey",
         Office == "Governor") %>% 
  mutate(year = as.integer(str_extract(id, "\\d{4}"))) %>%
  group_by(year, Name, Affiliation, County) %>%
  summarize(Vote = sum(Vote)) %>%
  group_by(year) %>%
  mutate(total_vote = sum(Vote)) %>% 
  filter(year >= "1810", year <= "1815") %>% 
  ggplot(aes(x = year, y = Vote, color = Name)) +
  geom_line() +
  geom_point()
```